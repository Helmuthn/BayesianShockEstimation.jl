<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · BayesianShockEstimation.jl</title><script data-outdated-warner src="assets/warner.js"></script><link rel="canonical" href="https://Helmuthn.github.io/BayesianShockEstimation.jl/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>BayesianShockEstimation.jl</a></span></div><form class="docs-search" action="search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a><ul class="internal"><li><a class="tocitem" href="#Shockwave-Density"><span>Shockwave Density</span></a></li><li><a class="tocitem" href="#Godunov-Scheme-for-Burgers&#39;-Equation"><span>Godunov Scheme for Burgers&#39; Equation</span></a></li><li><a class="tocitem" href="#RTS-Sampler-for-the-Random-Walk-Model"><span>RTS Sampler for the Random Walk Model</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/Helmuthn/BayesianShockEstimation.jl/blob/main/docs/src/index.md#" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="BayesianShockEstimation"><a class="docs-heading-anchor" href="#BayesianShockEstimation">BayesianShockEstimation</a><a id="BayesianShockEstimation-1"></a><a class="docs-heading-anchor-permalink" href="#BayesianShockEstimation" title="Permalink"></a></h1><p>Documentation for <a href="https://github.com/Helmuthn/BayesianShockEstimation.jl">BayesianShockEstimation</a>.</p><p>There are three main parts of the code for this project.</p><ul><li>Pushing Densities into Shockwaves</li><li>Godunov scheme for numerically solving Burgers&#39; equation</li><li>RTS Sampling of a random walk</li></ul><p>The novelty in this work comes from the numerical computation of shockwave densities, while the other sections can be considered standard.</p><h2 id="Shockwave-Density"><a class="docs-heading-anchor" href="#Shockwave-Density">Shockwave Density</a><a id="Shockwave-Density-1"></a><a class="docs-heading-anchor-permalink" href="#Shockwave-Density" title="Permalink"></a></h2><p>First, we introduce two structs for configuration of the simulation.  The first focuses on the numerical details, while the second focuses on the boundary conditions.</p><article class="docstring"><header><a class="docstring-binding" id="BayesianShockEstimation.ShockParams" href="#BayesianShockEstimation.ShockParams"><code>BayesianShockEstimation.ShockParams</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ShockParams</code></pre><p>Struct containing all needed information for deterministic shock simulations</p><p><strong>Parameters</strong></p><ul><li><code>stepsize_x</code>: Spatial grid size</li><li><code>stepsize_t</code>: Temporal grid size</li><li><code>stepcount</code> : Number of temporal steps</li><li><code>ballsize</code>  : Integration ball size</li><li><code>threshold</code> : Minimum shock threshold</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Helmuthn/BayesianShockEstimation.jl/blob/fe03157000db75080d48634c36214aa11404d0be/src/core.jl#L6-L18">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="BayesianShockEstimation.BoundaryParams" href="#BayesianShockEstimation.BoundaryParams"><code>BayesianShockEstimation.BoundaryParams</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">BoundaryParams</code></pre><p>Struct containing all needed information for boundary sampling</p><p><strong>Parameters</strong></p><ul><li><code>σ_w</code> : System noise standard deviation</li><li><code>σ_v</code> : Measurement noise standard deviation</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Helmuthn/BayesianShockEstimation.jl/blob/fe03157000db75080d48634c36214aa11404d0be/src/core.jl#L28-L37">source</a></section></article><p>Using these structs for configuration, the main function in this work computes the approximate shockwave arrival rate with a given number of Monte Carlo samples.</p><article class="docstring"><header><a class="docstring-binding" id="BayesianShockEstimation.ShockDensity" href="#BayesianShockEstimation.ShockDensity"><code>BayesianShockEstimation.ShockDensity</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">ShockDensity(  systemparams::ShockParams, 
               boundaryparams::BoundaryParams, 
               observations, 
               samplecount)</code></pre><p>Generates an approximation of the shock density function.</p><p><strong>Arguments</strong></p><ul><li><code>systemparams</code>   : Struct of parameters for system simulation</li><li><code>boundaryparams</code> : Struct of parameters for boundary simulation</li><li><code>observations</code>   : Boundary observations</li><li><code>samplecount</code>    : Number of Monte Carlo samples</li></ul><p><strong>Returns</strong></p><p>A 2D array of approximate shockwave densities</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Helmuthn/BayesianShockEstimation.jl/blob/fe03157000db75080d48634c36214aa11404d0be/src/core.jl#L44-L60">source</a></section></article><p>Within the function we do in-place updates to count of shockwaves from Monte Carlo samples using <code>IncrementShockCounts!</code>.</p><article class="docstring"><header><a class="docstring-binding" id="BayesianShockEstimation.IncrementShockCounts!" href="#BayesianShockEstimation.IncrementShockCounts!"><code>BayesianShockEstimation.IncrementShockCounts!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">IncrementShockCounts!(shockcounts, systemparams, boundary)</code></pre><p>Computes shocks for a given boundary.</p><p><strong>Arguments</strong></p><ul><li><code>shockcounts</code>     : Array of current shock counts</li><li><code>systemparams</code>    : Struct of parameters for system simulation</li><li><code>boundary_values</code> : Boundary samples</li></ul><p><strong>Returns</strong></p><p>A list of approximate densities</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Helmuthn/BayesianShockEstimation.jl/blob/fe03157000db75080d48634c36214aa11404d0be/src/core.jl#L91-L103">source</a></section></article><p>The <span>$\epsilon$</span> ball normalization term is computed using <code>BallVolume</code>.</p><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>BallVolume</code>. Check Documenter&#39;s build log for details.</p></div></div><h2 id="Godunov-Scheme-for-Burgers&#39;-Equation"><a class="docs-heading-anchor" href="#Godunov-Scheme-for-Burgers&#39;-Equation">Godunov Scheme for Burgers&#39; Equation</a><a id="Godunov-Scheme-for-Burgers&#39;-Equation-1"></a><a class="docs-heading-anchor-permalink" href="#Godunov-Scheme-for-Burgers&#39;-Equation" title="Permalink"></a></h2><p>To numerically compute the locations of shockwaves, we use Godunov&#39;s scheme for a discretization due to the balance of computational efficiency and the lack of advection error.</p><p>It is important to note that Gudonov&#39;s scheme introduces artificial viscosity into Burgers&#39; equation, and so we only search for regions with large derivatives.</p><p>The highest level function for this section is <code>godunov_burgers_1D_shocks</code>, which returns a 2D array of booleans indicating the locations of shocks for given boundary conditions.</p><article class="docstring"><header><a class="docstring-binding" id="BayesianShockEstimation.godunov_burgers_1D_shocks" href="#BayesianShockEstimation.godunov_burgers_1D_shocks"><code>BayesianShockEstimation.godunov_burgers_1D_shocks</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">godunov_burgers_1D_shocks(u0, dx, dt, stepcount, threshold)</code></pre><p>Finds spatial steps in the numerical solution of Burgers equation with a slope greater than the threshold. These points represent our approximations of shocks.</p><p><strong>Arguments</strong></p><ul><li><code>u0</code>        : Initial Boundary Condition</li><li><code>dx</code>        : Spatial grid size</li><li><code>dt</code>        : Temporal grid size</li><li><code>stepcount</code> : Number of steps</li><li><code>threshold</code> : slope threshold</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Helmuthn/BayesianShockEstimation.jl/blob/fe03157000db75080d48634c36214aa11404d0be/src/burgers.jl#L149-L162">source</a></section></article><p>One step lower level is the numerical solver itself.</p><article class="docstring"><header><a class="docstring-binding" id="BayesianShockEstimation.godunov_burgers_1D" href="#BayesianShockEstimation.godunov_burgers_1D"><code>BayesianShockEstimation.godunov_burgers_1D</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">godunov_burgers_1D(u0, dx, dt, stepcount)</code></pre><p>Solve Burgers&#39; equation numericallly with Godunov&#39;s method</p><p><strong>Arguments</strong></p><ul><li><code>u0</code>        : Initial Boundary Condition</li><li><code>dx</code>        : Spatial grid size</li><li><code>dt</code>        : Temporal grid size</li><li><code>stepcount</code> : Number of steps</li></ul><p><strong>Returns</strong></p><p>A 2D array representing the numerical solution of Burgers&#39; Equation</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Helmuthn/BayesianShockEstimation.jl/blob/fe03157000db75080d48634c36214aa11404d0be/src/burgers.jl#L114-L127">source</a></section></article><p>Individual timesteps are completed using <code>godunov_burgers_1D_step!</code>, which operates on a pre-allocated array.</p><article class="docstring"><header><a class="docstring-binding" id="BayesianShockEstimation.godunov_burgers_1D_step!" href="#BayesianShockEstimation.godunov_burgers_1D_step!"><code>BayesianShockEstimation.godunov_burgers_1D_step!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">godunov_burgers_1D_step!(u_next, boundary_flux, boundary_flux_right, u, dx, dt)</code></pre><p>Step Burgers&#39; equation according to Godunov&#39;s method</p><p><strong>Arguments</strong></p><ul><li><code>u_next</code>              : Array to store the value</li><li><code>boundary_flux</code>       : Array of boundary flux storage</li><li><code>boundary_flux_right</code> : Array of right boundary flux storage</li><li><code>u</code>                   : Array of values for the previous timestep</li><li><code>dx</code>                  : Spatial grid size</li><li><code>dt</code>                  : Temporal grid size</li></ul><p><strong>Returns</strong></p><p>An array of values for the next timestep</p><p><strong>Notes</strong></p><p>Assumes periodic boundary conditions</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Helmuthn/BayesianShockEstimation.jl/blob/fe03157000db75080d48634c36214aa11404d0be/src/burgers.jl#L85-L103">source</a></section></article><p>The flux function for Burgers equation is represented as <code>flux_burgers</code>.</p><article class="docstring"><header><a class="docstring-binding" id="BayesianShockEstimation.flux_burgers" href="#BayesianShockEstimation.flux_burgers"><code>BayesianShockEstimation.flux_burgers</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">flux_burgers(u)</code></pre><p>Helper function returns flux in from the conservation form of Burgers&#39; Equation.</p><p><strong>Arguments</strong></p><ul><li><code>u</code> : The state value</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Helmuthn/BayesianShockEstimation.jl/blob/fe03157000db75080d48634c36214aa11404d0be/src/burgers.jl#L1-L8">source</a></section></article><p>For any given boundary, the net flux is computed through an exact solution of the Riemann problem in <code>riemann_solver_burgers</code>.</p><article class="docstring"><header><a class="docstring-binding" id="BayesianShockEstimation.riemann_solver_burgers" href="#BayesianShockEstimation.riemann_solver_burgers"><code>BayesianShockEstimation.riemann_solver_burgers</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">riemann_solver_burgers(ul, ur)</code></pre><p>Solves the Riemann problem for Burgers&#39; equation and returns the average value. Helper function for Godunov&#39;s scheme.</p><p><strong>Arguments</strong></p><ul><li><code>ul</code> : The left state value</li><li><code>ur</code> : The right state value</li></ul><p><strong>Returns</strong></p><p>The value of flux on the boundary between the regions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Helmuthn/BayesianShockEstimation.jl/blob/fe03157000db75080d48634c36214aa11404d0be/src/burgers.jl#L13-L25">source</a></section></article><p>Finally, there are two helper functions to deal with fused operations and periodic boundary conditions.</p><article class="docstring"><header><a class="docstring-binding" id="BayesianShockEstimation.riemann_solver_burgers!" href="#BayesianShockEstimation.riemann_solver_burgers!"><code>BayesianShockEstimation.riemann_solver_burgers!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">riemann_solver_burgers!(boundary_flux_right, u)</code></pre><p>Solve for all right boundary flux values.</p><p><strong>Arguments</strong></p><ul><li><code>boundary_flux_right</code> : Output Array</li><li><code>u</code>                   : State Values</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Helmuthn/BayesianShockEstimation.jl/blob/fe03157000db75080d48634c36214aa11404d0be/src/burgers.jl#L53-L61">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="BayesianShockEstimation.flux_difference!" href="#BayesianShockEstimation.flux_difference!"><code>BayesianShockEstimation.flux_difference!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">flux_difference!(boundary_flux, boundary_flux_right)</code></pre><p>Compute the difference between the right and left flux</p><p><strong>Arguments</strong></p><ul><li><code>boundary_flux</code>       : output array</li><li><code>boundary_flux_right</code> : flux through right boundaries</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Helmuthn/BayesianShockEstimation.jl/blob/fe03157000db75080d48634c36214aa11404d0be/src/burgers.jl#L69-L77">source</a></section></article><h2 id="RTS-Sampler-for-the-Random-Walk-Model"><a class="docs-heading-anchor" href="#RTS-Sampler-for-the-Random-Walk-Model">RTS Sampler for the Random Walk Model</a><a id="RTS-Sampler-for-the-Random-Walk-Model-1"></a><a class="docs-heading-anchor-permalink" href="#RTS-Sampler-for-the-Random-Walk-Model" title="Permalink"></a></h2><p>Because the shockwave arrival rate estimation arises by pushing the boundary density through an implicit transformation, we include an implementation of an RTS sampler to sample the conditional boundary distribution given observations under a random walk model.</p><p>The sampler makes use of RTS smoothing variances, Kalman filter estimates, and Kalman filter variances, all of which are generated by <code>RTS_Smooth</code>.</p><article class="docstring"><header><a class="docstring-binding" id="BayesianShockEstimation.RTS_Smooth" href="#BayesianShockEstimation.RTS_Smooth"><code>BayesianShockEstimation.RTS_Smooth</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">RTS_Smooth(observations, σ_w, σ_v)</code></pre><p>Helper Function computing variance for RTS sampler by computing the Kalman filter estimates as well as the RTS smoother variances.</p><p>Applies to the random walk model</p><p class="math-container">\[\begin{aligned}
x_{t+1} &amp;= x_t + w_t\\
y_t     &amp;= x_t + v_t\\
\end{aligned}\]</p><p>where <span>$w_t$</span> and <span>$v_t$</span> are centered Gaussian random variables with variances <span>$σ_w^2$</span> and <span>$σ_v^2$</span>, respectively.</p><p><strong>Arguments</strong></p><ul><li><code>observations</code> : Timeseries observation</li><li><code>σ_w</code>          : System noise standard deviation</li><li><code>σ_v</code>          : Observaton noise standard deviation</li></ul><p><strong>Returns</strong></p><pre><code class="nohighlight hljs">estimates, variances, RTSvariances</code></pre><ul><li><code>estimates</code>    : Kalman filter estimates</li><li><code>variances</code>    : Kalman filter variances</li><li><code>RTSvariances</code> : RTS smoother variances</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Helmuthn/BayesianShockEstimation.jl/blob/fe03157000db75080d48634c36214aa11404d0be/src/rts.jl#L32-L61">source</a></section></article><p>The results of <code>RTS_Smooth</code> can then be used in <code>RTS_sample</code> to generate a single trajectory sample according to the RTS smoothing distribution.</p><article class="docstring"><header><a class="docstring-binding" id="BayesianShockEstimation.RTS_sample" href="#BayesianShockEstimation.RTS_sample"><code>BayesianShockEstimation.RTS_sample</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">RTS_sample(estimates, variances, RTSvariances, σ_w)</code></pre><p>Sample from RTS smoother backwards sampler for random walk model.</p><p>Uses the Kalman filter estimates and variances, as well as the RTS variances generated by <code>RTS_Smooth</code>.</p><p><strong>Arguments</strong></p><ul><li><code>estimates</code>    : Kalman filter estimates</li><li><code>variances</code>    : Kalman filter variances</li><li><code>RTSvariances</code> : RTS smoother variances</li><li><code>σ_w</code>          : System noise standard deviation</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Helmuthn/BayesianShockEstimation.jl/blob/fe03157000db75080d48634c36214aa11404d0be/src/rts.jl#L1-L16">source</a></section></article><p>The initial Kalman filter estimates are constructed through <code>KalmanFilterWalk</code>.</p><article class="docstring"><header><a class="docstring-binding" id="BayesianShockEstimation.KalmanFilterWalk" href="#BayesianShockEstimation.KalmanFilterWalk"><code>BayesianShockEstimation.KalmanFilterWalk</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">KalmanFilterWalk(observations, σ_w, σ_v)</code></pre><p>Computes the Kalman filter for a random walk model.</p><p class="math-container">\[\begin{aligned}
x_{t+1} &amp;= x_t + w_t\\
y_t     &amp;= x_t + v_t\\
\end{aligned}\]</p><p>where <span>$w_t$</span> and <span>$v_t$</span> are centered Gaussian random variables with variances <span>$σ_w^2$</span> and <span>$σ_v^2$</span>, respectively.</p><p><strong>Arguments</strong></p><ul><li><code>observations</code> : Timeseries observation</li><li><code>σ_w</code>          : System noise standard deviation</li><li><code>σ_v</code>          : Observaton noise standard deviation</li></ul><p><strong>Returns</strong></p><pre><code class="nohighlight hljs">estimates, variances</code></pre><ul><li><code>estimates</code> : Kalman filter estimates</li><li><code>variances</code> : Kalman filter variances</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Helmuthn/BayesianShockEstimation.jl/blob/fe03157000db75080d48634c36214aa11404d0be/src/rts.jl#L69-L94">source</a></section></article><p>The RTS variances are constructed through <code>BackwardsVarianceWalk</code>.</p><article class="docstring"><header><a class="docstring-binding" id="BayesianShockEstimation.BackwardsVarianceWalk" href="#BayesianShockEstimation.BackwardsVarianceWalk"><code>BayesianShockEstimation.BackwardsVarianceWalk</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">BackwardsVarianceWalk(variances, σ_w)</code></pre><p>Given Kalman filter variances, computes the RTS smoother variances.</p><p><strong>Arguments</strong></p><ul><li><code>variances</code> : Kalman filter variances</li><li><code>σ_w</code>       : System noise power</li></ul><p><strong>Returns</strong></p><p>The variances for the RTS smoother</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Helmuthn/BayesianShockEstimation.jl/blob/fe03157000db75080d48634c36214aa11404d0be/src/rts.jl#L113-L125">source</a></section></article></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Tuesday 28 February 2023 19:04">Tuesday 28 February 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
